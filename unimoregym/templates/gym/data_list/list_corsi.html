{% extends 'base_page.html' %}
{% load crispy_forms_tags %}

{% load static %}

{% block title %} Unimore training center {% endblock %}

{% block content %}
    <div class="container" style="margin-bottom: 40px">
    <h3 style="text-align: center"><strong>{{ titolo }}</strong></h3>

    <button type="button" class="btn btn-outline-info" id="toggle-formsearch">Cerca corso</button>
    <hr>
<div id="search-form" class="h-100 p-5 bg-light border rounded-3">
    <form method="GET">
        {% crispy form %}
    </form>
</div>
 <div class="row" style="margin: 20px">
{% for c in corsi_list %}
<div class="col-md-4">
<div class="card" style="width:250px">
    <img class="card-img-top" src="{% static '/imgs/unimore.png' %}" alt="Card image">
  <div class="card-body">
    <h5 class="card-title">{{ c.nome }}</h5>
    <p class="card-text">
        Corso tenuto da {{ c.fk_trainer.nome }} {{ c.fk_trainer.cognome }} <br>
        Categoria: {{ c.categoria }} <br>
        {{ c.descrizione }} <br><br>
        Valutazione Media: {{ c.valutazione_media }}<br>
        <a href="{% url 'unimoregym:list_ratings_corso' c.idcorso %}" class="link-primary">Vedi qui le recensioni</a>
        {% if user.is_authenticated %}
        <a class='btn btn-outline-info' href="{% url 'unimoregym:rate_corso' c.idcorso %}" style="margin-bottom: 5px">Valuta qui</a> <br>

        <a class="btn btn-outline-success ms-auto " href="{% url 'unimoregym:sessioni_corso' c.idcorso %}" type="submit" style="margin-right: 10px" >Prenota qui</a>
        {% else %}
            <p>Per attivare un abbonamento Ã¨ necessario registrarsi</p>
            <a class="btn btn-outline-success ms-auto " href="{% url 'register_client' %}" type="submit" style="margin-right: 10px" >Registrati qui</a>
        {% endif %}
        {% if "Owner" in user.groups.all.0.name or user.is_staff %}
            <form method="post" action="{% url 'unimoregym:corso_delete' c.pk %}" style="display:inline;">
                 {% csrf_token %}
                <button class="btn btn-outline-danger" type="submit">Elimina</button>
             </form>
        {% endif %}
    </p>
  </div>
</div>
</div>
     {% if forloop.counter|divisibleby:3 %}
                </div><div class="row" style="margin: 20px">
     {% endif %}
{%endfor%}
</div>
</div>

    <script>
        document.getElementById('toggle-formsearch').addEventListener('click', function() {
            var form = document.getElementById('search-form');
            if (form.style.display === 'none') {
                form.style.display = 'block';
            } else {
                form.style.display = 'none';
            }
        });
    </script>

{% endblock %}